<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
  <title>QYan</title>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <link rel="stylesheet" href="/css/style.css?v=63" />
  <!-- Prevent browser zoom (Ctrl+scroll, Ctrl+±, pinch) -->
  <script>
    document.addEventListener('wheel', function(e){ if(e.ctrlKey){ e.preventDefault(); } }, { passive: false });
    document.addEventListener('keydown', function(e){ if(e.ctrlKey && (e.key==='+' || e.key==='-' || e.key==='=' || e.key==='0')){ e.preventDefault(); } });
    (function () {
      const params = new URLSearchParams(window.location.search);
      if (params.get('quiz') && params.get('mode') === 'host') {
        document.documentElement.classList.add('autohost-launch');
      }
    })();
  </script>
</head>
<body>

  <!-- Global mute toggle (always visible) -->
  <button class="btn-mute" id="btn-mute" title="Toggle sound">🔊</button>

  <!-- ═══════════════════════════════════════════
       VIEW: Home — Choose Host or Player
  ═══════════════════════════════════════════ -->
  <div id="view-home" class="view active">
    <img class="home-hero-logo" src="/images/QYan_logo_300x164.jpg" alt="QYan" />
    <div class="card center-card">
      <h1 class="logo">⚡ QYan</h1>
      <p class="subtitle">Real-time multiplayer quiz</p>
      <p id="quiz-title-banner" style="display:none; font-size:1.1rem; font-weight:600; color:#60a5fa; margin:0.25rem 0 0.75rem; text-align:center;"></p>
      <div class="btn-group vertical">
        <button class="btn btn-primary" id="btn-become-host">
          🎙️ I'm a Host
        </button>
        <button class="btn btn-secondary" id="btn-become-player">
          🙋 I'm a Player
        </button>
      </div>
      <button class="btn btn-secondary full-width" id="btn-open-test-home" onclick="window.__openTestPanel && window.__openTestPanel()" style="margin-top:10px; border:2px dashed rgba(96,165,250,.55);">
        🧪 Test Renderers
      </button>
      <p class="build-time" id="build-time">Loading version…</p>
    </div>

    <button id="btn-open-test-bottom" class="btn btn-primary" onclick="window.__openTestPanel && window.__openTestPanel()" style="
      position: fixed;
      left: 50%;
      bottom: 14px;
      transform: translateX(-50%);
      z-index: 10002;
      padding: 10px 18px;
      border-radius: 999px;
      font-weight: 700;
      box-shadow: 0 8px 20px rgba(0,0,0,.35);
    ">
      🧪 Test Renderers
    </button>
  </div>

  <!-- ═══════════════════════════════════════════
       VIEW: Host — Loading (before room is ready)
  ═══════════════════════════════════════════ -->
  <div id="view-host-loading" class="view">
    <div class="card center-card host-loading-card">
      <img class="studio-logo host-loading-logo" src="/images/QYan_logo_300x164.jpg" alt="QYan logo" />
      <h2>Preparing your game</h2>
      <p class="waiting-text">Loading quiz data and creating room…</p>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════
       VIEW: Player — Join Room Form
  ═══════════════════════════════════════════ -->
  <div id="view-player-join" class="view">
    <div class="card center-card">
      <button class="btn-back" id="btn-back-from-join">← Back</button>
      <img class="studio-logo" src="/images/QYan_logo_300x164.jpg" alt="QYan logo" style="margin-bottom:0.1rem;" />
      <span style="font-size:0.75rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--text-dim);opacity:0.7;margin-bottom:0.5rem;">QYan 2026</span>
      <h2 dir="rtl">انضم إلى لعبة</h2>
      <p id="join-quiz-title-banner" style="display:none; font-size:1rem; font-weight:600; color:#60a5fa; margin:0 0 0.75rem; text-align:center;"></p>
      <div id="scan-fallback-banner" class="scan-fallback" style="display:none">
        <strong>Having trouble after scanning?</strong>
        <span>Use the Room PIN shown on the host screen and join manually.</span>
      </div>
      <form id="form-join">
        <div class="field">
          <label for="input-pin">Room PIN</label>
          <input
            id="input-pin"
            type="text"
            inputmode="numeric"
            pattern="[0-9]*"
            maxlength="6"
            placeholder="e.g. 482910"
            autocomplete="off"
            required
          />
        </div>
        <div class="field">
          <label for="input-nickname">Your Nickname</label>
          <div class="nickname-avatar-row">
            <input
              id="input-nickname"
              type="text"
              maxlength="20"
              placeholder="e.g. SuperQuizzer"
              autocomplete="off"
              required
            />
            <button type="button" id="join-avatar-btn" class="avatar-trigger-btn avatar-trigger-inline">
              <span class="avatar-trigger-icon" id="join-avatar-display">🎮</span>
            </button>
          </div>
        </div>
        <p class="error-msg" id="join-error"></p>
        <button type="submit" class="btn btn-primary full-width">Join Game</button>
      </form>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════
       VIEW: Host — Lobby (waiting for players)
  ═══════════════════════════════════════════ -->
  <div id="view-host-lobby" class="view">
    <div class="card host-lobby-card">
      <div class="lobby-header">
        <div class="lobby-mode-corner">
          <span class="mode-indicator" id="mode-indicator">🌐 Global</span>
          <span class="mode-warning" id="mode-warning" style="display:none"></span>
          <!-- Burger — all controls live inside -->
          <div class="anim-preset-anchor" id="host-burger-anchor">
            <button class="btn-mode-icon" id="btn-back-from-host-lobby" title="Menu" aria-label="Menu">
              <svg viewBox="0 0 20 20" fill="currentColor" width="14" height="14"><path d="M3 5.75A.75.75 0 0 1 3.75 5h12.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 5.75Zm0 4.25a.75.75 0 0 1 .75-.75h12.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 10Zm0 4.25a.75.75 0 0 1 .75-.75h12.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z"/></svg>
            </button>
            <div class="host-home-menu" id="host-home-menu" style="display:none">

              <!-- Mode -->
              <div class="burger-section-label">Connection Mode</div>
              <div class="burger-mode-row">
                <button class="burger-mode-btn" id="btn-mode-local">
                  <svg viewBox="0 0 20 20" fill="currentColor" width="14" height="14"><path d="M2.94 7.5a11.98 11.98 0 0 1 14.12 0l-1.18 1.56a9.98 9.98 0 0 0-11.76 0L2.94 7.5Zm2.35 3.1a7.98 7.98 0 0 1 9.42 0l-1.18 1.56a5.98 5.98 0 0 0-7.06 0L5.29 10.6Zm2.35 3.1a3.98 3.98 0 0 1 4.72 0L11.18 15.25a1.98 1.98 0 0 0-2.36 0L7.64 13.7ZM10 16.5a1.2 1.2 0 1 1 0 2.4 1.2 1.2 0 0 1 0-2.4Z"/></svg>
                  Local LAN
                </button>
                <button class="burger-mode-btn" id="btn-mode-global">
                  <svg viewBox="0 0 20 20" fill="currentColor" width="14" height="14"><path d="M10 1.5a8.5 8.5 0 1 0 0 17 8.5 8.5 0 0 0 0-17Zm6.61 7.5h-2.15a12.76 12.76 0 0 0-1.15-4.02A6.54 6.54 0 0 1 16.6 9Zm-6.61-5.2c.7 0 1.84 1.6 2.36 5.2H7.64c.52-3.6 1.66-5.2 2.36-5.2ZM3.39 11h2.15c.16 1.43.55 2.82 1.15 4.02A6.54 6.54 0 0 1 3.39 11Zm2.15-2H3.39a6.54 6.54 0 0 1 3.3-4.02A12.76 12.76 0 0 0 5.54 9Zm1.99 0h4.94A15.7 15.7 0 0 0 11.3 4.1c1.55.52 2.8 2.33 3.23 4.9H7.53Zm6.97 2c-.43 2.57-1.68 4.38-3.23 4.9.6-1.2 1-2.59 1.16-4.9h2.07Zm-6.97 0h4.94c-.51 3.6-1.66 5.2-2.36 5.2-.7 0-1.84-1.6-2.36-5.2Z"/></svg>
                  Global Web
                </button>
              </div>
              <div class="burger-divider"></div>

              <!-- Animation presets -->
              <div class="burger-section-label">Player Animation</div>
              <div class="anim-preset-grid" id="anim-preset-menu">
                <button class="anim-preset-btn anim-preset-active" data-value="auto">✨ Auto</button>
                <button class="anim-preset-btn" data-value="neonArcade">🕹 Neon Arcade</button>
                <button class="anim-preset-btn" data-value="quizArena">🏆 Quiz Arena</button>
                <button class="anim-preset-btn" data-value="partyConfetti">🎉 Party Confetti</button>
              </div>
              <div class="burger-divider"></div>

              <!-- Theme toggle -->
              <button class="host-home-menu-btn burger-theme-row" id="btn-theme-toggle">
                <span class="burger-theme-icons">
                  <svg id="icon-theme-moon" viewBox="0 0 20 20" fill="currentColor" width="15" height="15"><path d="M17.293 13.293A8 8 0 0 1 6.707 2.707a8.001 8.001 0 1 0 10.586 10.586z"/></svg>
                  <svg id="icon-theme-sun" viewBox="0 0 20 20" fill="currentColor" width="15" height="15" style="display:none"><path d="M10 2a1 1 0 0 1 1 1v1a1 1 0 1 1-2 0V3a1 1 0 0 1 1-1Zm4.22 1.78a1 1 0 0 1 1.415 1.414l-.707.707a1 1 0 0 1-1.414-1.414l.707-.707ZM18 9a1 1 0 1 1 0 2h-1a1 1 0 1 1 0-2h1Zm-2.78 5.78a1 1 0 0 1-1.414 1.414l-.707-.707a1 1 0 0 1 1.414-1.414l.707.707ZM10 17a1 1 0 0 1-1-1v-1a1 1 0 1 1 2 0v1a1 1 0 0 1-1 1Zm-5.78-2.22a1 1 0 0 1 0-1.414l.707-.707a1 1 0 0 1 1.414 1.414l-.707.707a1 1 0 0 1-1.414 0ZM3 11a1 1 0 1 1 0-2h1a1 1 0 1 1 0 2H3Zm1.22-6.78a1 1 0 0 1 1.414 0l.707.707A1 1 0 0 1 4.927 6.34l-.707-.707a1 1 0 0 1 0-1.414ZM10 7a3 3 0 1 0 0 6 3 3 0 0 0 0-6Z"/></svg>
                </span>
                <span class="host-menu-item-title" id="theme-toggle-label">Switch to Light</span>
              </button>
              <div class="burger-divider"></div>

              <!-- Room / session actions -->
              <button class="host-home-menu-btn" id="btn-home-menu-host">
                <span class="host-menu-item-title">Host</span>
                <span class="host-menu-item-desc">Start a fresh host room on this device</span>
              </button>
              <button class="host-home-menu-btn" id="btn-home-menu-player">
                <span class="host-menu-item-title">Player</span>
                <span class="host-menu-item-desc">Switch this device to player join mode</span>
              </button>
              <label class="host-home-menu-toggle" for="chk-host-as-player">
                <span class="host-menu-item-title">Join as player too</span>
                <span class="host-menu-item-desc">Play from this host device in the same room</span>
                <input type="checkbox" id="chk-host-as-player" />
              </label>
            </div>
          </div>
          <!-- Hidden select keeps game.js API intact -->
          <select id="host-stage-variant" style="display:none">
            <option value="auto" selected>Auto (Random)</option>
            <option value="neonArcade">Neon Arcade</option>
            <option value="quizArena">Quiz Arena</option>
            <option value="partyConfetti">Party Confetti</option>
          </select>
        </div>
        <!-- Logo — right side of header -->
        <div class="host-header-logo">
          <img class="studio-logo" src="/images/QYan_logo_300x164.jpg" alt="QYan logo" />
        </div>
      </div>

      <!-- Hidden mode URL + copy (functional, not shown in UI) -->
      <div class="mode-toggle" style="display:none">
        <div class="mode-header"></div>
        <div class="mode-buttons"></div>
        <p class="mode-url" id="host-join-url">—</p>
        <button class="btn btn-secondary full-width" id="btn-copy-join-url">📋 Copy Join URL</button>
      </div>

      <div class="host-pin-qr-row">
        <div class="pin-display">
          <span class="pin-label">Room PIN</span>
          <span class="host-quiz-title" id="host-quiz-title" style="display:none"></span>
          <span class="pin-code" id="host-pin">------</span>
        </div>
        <!-- QR Code for players to scan -->
        <div class="qr-section">
          <div class="qr-wrapper">
            <div id="host-qr-canvas"></div>
          </div>
        </div>
      </div>

      <!-- ── Player grid (placeholders fill → real cards as players join) ── -->
      <div id="host-as-player-section" class="host-as-player-section">
        <div class="host-as-player-header">
          <span class="host-as-player-label" dir="rtl">اللاعبون</span>
          <span class="host-as-player-count" id="host-player-count">0</span>
        </div>
        <ul class="host-player-stage" id="host-player-list" aria-label="Players joined"></ul>
        <p class="player-waiting-msg" id="player-waiting-msg">Need at least one player to start</p>
        <div id="host-player-form" class="host-player-form" style="display:none;">
          <div class="host-player-row">
            <input type="text" id="host-player-nickname" maxlength="20" placeholder="Your nickname…" class="host-player-input" />
            <button id="btn-host-join-as-player" class="btn btn-secondary host-player-confirm">Join</button>
            <button id="btn-host-cancel-join" class="btn host-player-cancel" title="Cancel" aria-label="Cancel">Cancel</button>
          </div>
          <p id="host-as-player-status" class="host-player-status"></p>
        </div>
      </div>

      <!-- Share + Start Game row -->
      <div class="start-game-row">
        <!-- Share URL bar -->
        <div class="share-url-section" id="share-url-section">
          <input type="text" id="share-url-input" readonly style="display:none" />
        <button class="share-trigger-btn" id="btn-share-menu" title="Share invite link" aria-label="Share" aria-expanded="false">
          <svg viewBox="0 0 20 20" fill="currentColor" width="15" height="15"><path d="M13 4.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0Zm0 11a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0ZM2 10a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0Zm10.53-3.613a.75.75 0 0 0-.749-1.3l-5.25 3a.75.75 0 0 0 .749 1.3l5.25-3Zm-.749 6.226a.75.75 0 0 0 .75-1.3l-5.25-3a.75.75 0 0 0-.75 1.3l5.25 3Z"/></svg>
        </button>
        <div class="share-actions" id="share-actions" aria-hidden="true">
          <button class="share-icon-btn" id="btn-share-copy" title="Copy link" aria-label="Copy link">
            <svg viewBox="0 0 20 20" fill="currentColor" width="15" height="15"><path d="M7 3.5A1.5 1.5 0 0 1 8.5 2h3.879a1.5 1.5 0 0 1 1.06.44l3.122 3.12A1.5 1.5 0 0 1 17 6.622V12.5a1.5 1.5 0 0 1-1.5 1.5h-1v-3.379a3 3 0 0 0-.879-2.121L10.5 5.379A3 3 0 0 0 8.379 4.5H7v-1Z"/><path d="M4.5 6A1.5 1.5 0 0 0 3 7.5v9A1.5 1.5 0 0 0 4.5 18h7a1.5 1.5 0 0 0 1.5-1.5v-5.879a1.5 1.5 0 0 0-.44-1.06L9.44 6.439A1.5 1.5 0 0 0 8.378 6H4.5Z"/></svg>
          </button>
          <a id="share-whatsapp" class="share-social-btn share-wa" href="#" target="_blank" rel="noopener" aria-label="Share on WhatsApp">
            <svg viewBox="0 0 24 24" fill="currentColor" width="15" height="15"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
          </a>
          <a id="share-telegram" class="share-social-btn share-tg" href="#" target="_blank" rel="noopener" aria-label="Share on Telegram">
            <svg viewBox="0 0 24 24" fill="currentColor" width="15" height="15"><path d="M11.944 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0a12 12 0 00-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 01.171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/></svg>
          </a>
          <a id="share-twitter" class="share-social-btn share-tw" href="#" target="_blank" rel="noopener" aria-label="Share on X">
            <svg viewBox="0 0 24 24" fill="currentColor" width="15" height="15"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-4.714-6.231-5.401 6.231H2.744l7.73-8.835L1.254 2.25H8.08l4.259 5.63L18.244 2.25zm-1.161 17.52h1.833L7.084 4.126H5.117L17.083 19.77z"/></svg>
          </a>
        </div>
        <button class="btn btn-success" id="btn-start-game" disabled>
          🚀 Start Game
        </button>
      </div>

    </div>
  </div>

  <!-- ═══════════════════════════════════════════
       VIEW: Player — Lobby (waiting for host)
  ═══════════════════════════════════════════ -->
  <div id="view-player-lobby" class="view">
    <div class="card lobby-card">
      <img class="studio-logo" src="/images/QYan_logo_300x164.jpg" alt="QYan logo" />
      <div class="pin-display">
        <span class="pin-label">Room PIN</span>
        <span class="pin-code" id="player-room-pin">------</span>
        <span class="difficulty-label" id="player-lobby-difficulty">🟡 Difficulty: Classic</span>
      </div>
      <p class="waiting-text">
        Waiting for the host to start…
      </p>
      <!-- Edit profile before game starts -->
      <div style="display:flex;flex-direction:column;gap:8px;width:100%;">
        <button class="edit-profile-toggle" id="btn-edit-profile">✏️ Edit Name &amp; Avatar</button>
        <div class="edit-profile-panel" id="edit-profile-panel">
          <div class="field" style="gap:6px;">
            <label>Nickname</label>
            <div class="edit-profile-row">
              <input id="edit-nickname-input" class="edit-profile-input" maxlength="20" placeholder="New nickname" autocomplete="off" />
              <button type="button" class="btn btn-primary" id="btn-save-profile" style="padding:10px 18px;white-space:nowrap">Save</button>
            </div>
            <p class="error-msg" id="edit-profile-error"></p>
          </div>
          <div class="field" style="gap:6px;">
            <label>Avatar</label>
            <button type="button" id="lobby-avatar-btn" class="avatar-trigger-btn">
              <span class="avatar-trigger-icon" id="lobby-avatar-display">🎮</span>
              <span class="avatar-trigger-label">Change Avatar</span>
              <span class="avatar-trigger-arrow">›</span>
            </button>
          </div>
        </div>
      </div>
      <div class="player-list-section">
        <h3>Players in room (<span id="player-player-count">0</span>)</h3>
        <ul class="player-list" id="player-player-list"></ul>
      </div>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════
       VIEW: Question — Host sees question + live counter
  ═══════════════════════════════════════════ -->
  <div id="view-host-question" class="view">
    <div class="question-layout" id="host-question-layout">
      <div class="question-header">
        <span class="q-progress" id="host-q-progress">Q 1 / 8</span>
        <span class="difficulty-tag" id="host-q-difficulty">Classic</span>
        <div class="timer-ring" id="host-timer-ring">
          <span class="timer-count" id="host-timer-count">30</span>
        </div>
        <span class="answer-counter" id="host-answer-counter">0 / 0 answered</span>
      </div>
      <!-- Host controls -->
      <div class="host-controls">
        <button class="btn btn-host-ctrl" id="btn-pause-resume">⏸️ Pause</button>
        <button class="btn btn-host-ctrl btn-skip" id="btn-skip">⏩ Skip</button>
        <button class="btn btn-host-ctrl btn-end" id="btn-end-game">🛑 End Game</button>
      </div>
      <div class="question-text-box">
        <p class="question-text" id="host-question-text">Loading question…</p>
      </div>
      <div id="host-boss-panel" class="boss-panel" style="display:none">
        <div class="boss-row">
          <span class="boss-name" id="host-boss-name">QYan Boss</span>
          <span class="boss-hp" id="host-boss-hp">100 / 100</span>
        </div>
        <div class="boss-bar"><div class="boss-bar-fill" id="host-boss-bar-fill"></div></div>
      </div>
      <div class="options-grid" id="host-options-grid">
        <!-- 4 option cards injected by game.js -->
      </div>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════
       VIEW: Question — Player sees question + answer buttons
  ═══════════════════════════════════════════ -->
  <div id="view-player-question" class="view">
    <div class="question-layout" id="player-question-layout">
      <div class="question-header">
        <span class="q-progress" id="player-q-progress">Q 1 / 8</span>
        <span class="difficulty-tag" id="player-q-difficulty">Classic</span>
        <div class="timer-ring" id="player-timer-ring">
          <span class="timer-count" id="player-timer-count">30</span>
        </div>
        <span class="score-badge" id="player-score-badge">💎 <span id="player-score-count">0</span> pts</span>
        <span class="streak-badge" id="player-streak-badge" style="display:none">🔥 <span id="player-streak-count">0</span></span>
        <span class="role-badge" id="player-role-badge" style="display:none">Role: —</span>
      </div>
      <div class="question-text-box">
        <p class="question-text" id="player-question-text">Loading question…</p>
      </div>
      <div class="options-grid" id="player-options-grid">
        <!-- single / multi buttons injected by game.js -->
      </div>

      <div id="player-type-container" class="type-container" style="display:none">
        <input id="player-type-input" type="text" autocomplete="off" placeholder="Type your answer" />
      </div>

      <div id="player-boss-panel" class="boss-panel" style="display:none">
        <div class="boss-row">
          <span class="boss-name" id="player-boss-name">QYan Boss</span>
          <span class="boss-hp" id="player-boss-hp">100 / 100</span>
        </div>
        <div class="boss-bar"><div class="boss-bar-fill" id="player-boss-bar-fill"></div></div>
      </div>

      <!-- ── Match: drag-and-drop layout (built by JS) ── -->
      <div id="player-match-container" class="match-container" style="display:none"></div>

      <!-- ── Order: drag-to-sort list ── -->
      <div id="player-order-container" class="order-container" style="display:none">
        <ol class="order-list" id="order-list"></ol>
      </div>

      <!-- Submit button for multi / match / order (hidden for single) -->
      <button id="btn-submit-answer" class="btn btn-success full-width" style="display:none">
        ✔ تأكيد الإجابة
      </button>

      <div id="player-role-panel" class="role-panel" style="display:none">
        <p id="player-role-panel-title">Role ability</p>
        <div class="role-controls">
          <select id="role-target-select"></select>
          <button id="btn-role-action" class="btn btn-secondary" type="button">Use ability</button>
        </div>
        <p id="player-role-hint" class="hint-text"></p>
      </div>

      <p class="answered-msg" id="player-answered-msg"></p>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════
       OVERLAY: Game Paused
  ═══════════════════════════════════════════ -->
  <div id="overlay-paused" class="pause-overlay" style="display:none">
    <div class="pause-card">
      <p class="pause-icon">⏸️</p>
      <h2>Game Paused</h2>
      <p class="pause-sub">Waiting for the host to resume…</p>
      <button class="btn btn-primary" id="btn-overlay-resume" style="display:none">
        ▶️ Resume Game
      </button>
    </div>
  </div>

  <div id="overlay-frozen" class="pause-overlay" style="display:none">
    <div class="pause-card">
      <p class="pause-icon">❄️</p>
      <h2>Screen Frozen</h2>
      <p class="pause-sub" id="frozen-msg">Saboteur used freeze ability</p>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════
       VIEW: Question Result (correct answer reveal)
  ═══════════════════════════════════════════ -->
  <div id="view-question-result" class="view">
    <div class="card center-card result-card">
      <img src="/images/QYan_logo_300x164.jpg" alt="QYan" style="width:90px;border-radius:10px;margin-bottom:0.25rem;opacity:0.85;" />
      <h2 id="result-correct-label">✅ الإجابة الصحيحة</h2>
      <p class="result-answer" id="result-correct-answer">—</p>
      <!-- For match / order types: correct pairs / sorted items -->
      <ul class="result-pairs-list" id="result-pairs-list" style="display:none"></ul>
      <p id="result-player-score-msg" class="result-score-msg"></p>
      <p id="result-streak-msg" class="result-streak-msg"></p>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════
       VIEW: Leaderboard (between questions)
  ═══════════════════════════════════════════ -->
  <div id="view-leaderboard" class="view">
    <div class="card leaderboard-card">
      <img src="/images/QYan_logo_300x164.jpg" alt="QYan" style="width:90px;border-radius:10px;margin-bottom:0.25rem;opacity:0.85;" />
      <h2 class="lb-title" id="lb-title">🏆 Leaderboard</h2>
      <ol class="leaderboard-list" id="leaderboard-list"></ol>
      <p class="lb-next-hint" id="lb-next-hint">Next question coming up…</p>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════
       VIEW: Game Over — Podium Ceremony
  ═══════════════════════════════════════════ -->
  <div id="view-game-over" class="view">
    <div class="podium-ceremony">

      <h2 class="podium-title" id="podium-title">🎉 Final Results</h2>

      <!-- ── Podium Stage ── -->
      <div class="podium-stage" id="podium-stage">

        <!-- 2nd place — left -->
        <div class="podium-col podium-2nd" id="podium-slot-2">
          <div class="podium-avatar-wrap">
            <div class="podium-avatar" id="podium-avatar-2">🎮</div>
            <div class="podium-nickname" id="podium-name-2">—</div>
            <div class="podium-score" id="podium-score-2">0 pts</div>
          </div>
          <div class="podium-block podium-block-2">
            <span class="podium-medal">🥈</span>
            <span class="podium-rank-num">2</span>
          </div>
        </div>

        <!-- 1st place — center (tallest) -->
        <div class="podium-col podium-1st" id="podium-slot-1">
          <div class="podium-avatar-wrap">
            <div class="podium-trophy-crown">🏆</div>
            <div class="podium-avatar podium-avatar-gold" id="podium-avatar-1">🎮</div>
            <div class="podium-nickname podium-nickname-gold" id="podium-name-1">—</div>
            <div class="podium-score podium-score-gold" id="podium-score-1">0 pts</div>
          </div>
          <div class="podium-block podium-block-1">
            <span class="podium-medal">🥇</span>
            <span class="podium-rank-num">1</span>
          </div>
        </div>

        <!-- 3rd place — right -->
        <div class="podium-col podium-3rd" id="podium-slot-3">
          <div class="podium-avatar-wrap">
            <div class="podium-avatar" id="podium-avatar-3">🎮</div>
            <div class="podium-nickname" id="podium-name-3">—</div>
            <div class="podium-score" id="podium-score-3">0 pts</div>
          </div>
          <div class="podium-block podium-block-3">
            <span class="podium-medal">🥉</span>
            <span class="podium-rank-num">3</span>
          </div>
        </div>

      </div><!-- /podium-stage -->

      <!-- ── Full leaderboard (fades in after podium ceremony) ── -->
      <div class="podium-full-results" id="podium-full-results">
        <div id="winner-announcement" class="winner-announcement" style="display:none">
          <p class="winner-label">🏆 Winner</p>
          <p class="winner-name" id="winner-name">—</p>
          <p class="winner-score" id="winner-score">0 pts</p>
        </div>
        <details class="podium-details" id="podium-details">
          <summary class="podium-details-summary">📋 Full Leaderboard</summary>
          <ol class="leaderboard-list" id="final-leaderboard-list"></ol>
        </details>
        <div class="podium-actions">
          <button class="btn btn-success full-width" id="btn-start-new-session" style="display:none">
            🔄 Start New Session
          </button>
          <button class="btn btn-primary full-width" id="btn-play-again">
            🔁 Play Again
          </button>
        </div>
      </div>

    </div><!-- /podium-ceremony -->
  </div>

  <!-- ═══════════════════════════════════════════
       VIEW: Room Closed (host disconnected)
  ═══════════════════════════════════════════ -->
  <div id="view-room-closed" class="view">
    <div class="card center-card">
      <h2>🚪 Room Closed</h2>
      <p id="room-closed-msg">The host has left the game.</p>
      <button class="btn btn-primary full-width" id="btn-home-from-closed">
        Back to Home
      </button>
    </div>
  </div>

  <!-- Avatar Picker Modal (shared) -->
  <div id="avatar-picker-modal" class="avatar-picker-modal" style="display:none" role="dialog" aria-modal="true" aria-label="Choose your avatar">
    <div class="avatar-picker-dialog">
      <div class="avatar-picker-header">
        <span>Choose Your Avatar</span>
        <button type="button" id="btn-close-avatar-picker" class="avatar-picker-close">&times;</button>
      </div>
      <div class="avatar-grid" id="modal-avatar-grid"></div>
    </div>
  </div>

  <div id="join-debug-modal" class="join-debug-modal" style="display:none" role="dialog" aria-modal="true" aria-label="Join diagnostics">
    <div class="join-debug-dialog">
      <div class="join-debug-header">
        <strong>Join Diagnose</strong>
        <button type="button" id="btn-close-join-debug" class="join-debug-close" aria-label="Close diagnostics">&times;</button>
      </div>
      <div class="join-debug-meta">
        <span id="join-debug-pin">PIN: -</span>
        <span id="join-debug-nick">Nick: -</span>
      </div>
      <div id="join-debug-log" class="join-debug-log"></div>
    </div>
  </div>

  <div class="qyan-attribution" aria-label="QYan attribution">
    <span>© QYan — Prototype build</span>
  </div>

  <!-- ─── Inline debug: runs BEFORE any external script ─── -->
  <script>
    (function() {
      // v58 - Comprehensive UTF-8 encoding fix for Arabic text and emojis
      var dbg = document.createElement('div');
      dbg.id = 'inline-dbg';
      dbg.style.cssText = 'position:fixed;top:0;left:0;right:0;z-index:99999;background:#111;color:#0f0;font:bold 10px monospace;padding:4px 8px;pointer-events:auto;opacity:0.95;display:flex;align-items:center;gap:8px;overflow-x:auto;border-bottom:1px solid #0f0;';
      
      var status = document.createElement('span');
      status.id = 'dbg-status';
      status.textContent = 'v54 boot';
      dbg.appendChild(status);

      var flags = document.createElement('span');
      flags.id = 'dbg-flags';
      flags.style.cssText = 'color:#9f9;font:normal 10px monospace;white-space:nowrap;';
      flags.textContent = '';
      dbg.appendChild(flags);

      var btnWrap = document.createElement('div');
      btnWrap.style.cssText = 'display:flex;gap:4px;';
      
      var views = ['view-home', 'view-host-lobby', 'view-host-question', 'view-player-join', 'view-player-lobby', 'view-player-question', 'view-leaderboard', 'view-game-over'];
      views.forEach(function(vid) {
        var b = document.createElement('button');
        b.textContent = vid.replace('view-', '');
        b.style.cssText = 'background:#222;color:#fff;border:1px solid #444;padding:2px 4px;font-size:9px;cursor:pointer;border-radius:3px;';
        b.onclick = function() { 
          // Prefer the app's real view switcher. Fallback keeps it non-destructive.
          var showFn = window._showView || (typeof showView === 'function' ? showView : null);
          if (showFn) {
            showFn(vid);
            status.textContent = 'VIEW: ' + vid;
            return;
          }

          // Fallback: class toggle only (do NOT write display:none inline).
          document.querySelectorAll('.view').forEach(v => {
            v.classList.remove('active');
            v.style.display = '';
          });
          var target = document.getElementById(vid);
          if (target) {
            target.style.display = '';
            target.classList.add('active');
            status.textContent = 'VIEW: ' + vid;
          }
        };
        btnWrap.appendChild(b);
      });
      dbg.appendChild(btnWrap);

      //  Separator
      var sep = document.createElement('span');
      sep.style.cssText = 'color:#444;padding:0 2px;';
      sep.textContent = '|';
      dbg.appendChild(sep);

      //  Fake-Q button: calls renderHostQuestion with test data
      var fakeBtn = document.createElement('button');
      fakeBtn.textContent = 'TEST-Q';
      fakeBtn.style.cssText = 'background:#1a1a3a;color:#88f;border:1px solid #44f;padding:2px 5px;font-size:9px;cursor:pointer;border-radius:3px;';
      fakeBtn.onclick = function() {
        var fakeData = {
          questionIndex: 0, total: 3, duration: 30,
          question: { type: 'single', text: 'TEST: What is 2+2?', options: ['3','4','5','6'] },
          players: []
        };
        try {
          if (window._qState) {
            window._qState.questionStartTime = Date.now();
            window._qState.questionDuration = 30;
            window._qState.currentQuestionType = 'single';
          }
          var renderFn = window._renderHostQuestion || (typeof renderHostQuestion !== 'undefined' ? renderHostQuestion : null);
          if (renderFn) {
            renderFn(fakeData);
            status.textContent = 'TEST-Q OK - check h-quest view';
          } else {
            status.textContent = 'ERR: renderHostQuestion not loaded yet';
          }
        } catch(e) {
          status.textContent = 'CRASH: ' + e.message.substring(0,35);
          console.error('[v54] fake-Q crash:', e);
        }
      };
      dbg.appendChild(fakeBtn);

      // Open question-only mirror tab (host)
      var popBtn = document.createElement('button');
      popBtn.textContent = 'POP-Q';
      popBtn.style.cssText = 'background:#1f2937;color:#fff;border:1px solid #4b5563;padding:2px 5px;font-size:9px;cursor:pointer;border-radius:3px;';
      popBtn.title = 'Open a question-only tab (mirrors host questions)';
      popBtn.onclick = function() {
        try {
          var u = new URL(window.location.href);
          u.searchParams.set('questionOnly', 'host');
          // Keep existing params (pin/quiz/mode) if present; question-only ignores them.
          window.open(u.toString(), '_blank', 'noopener');
        } catch (e) {
          console.error('[v54] POP-Q failed', e);
        }
      };
      dbg.appendChild(popBtn);

      //  Inspect button: shows active view dimensions
      var inspBtn = document.createElement('button');
      inspBtn.textContent = 'INSP';
      inspBtn.style.cssText = 'background:#2a1a1a;color:#f88;border:1px solid #f44;padding:2px 5px;font-size:9px;cursor:pointer;border-radius:3px;';
      inspBtn.onclick = function() {
        var active = document.querySelector('.view.active');
        if (!active) { status.textContent = 'no active view'; return; }
        var r = active.getBoundingClientRect();
        var child = active.firstElementChild;
        var cr = child ? child.getBoundingClientRect() : null;
        var cs = window.getComputedStyle(active);
        var transform = cs.transform;
        var position = cs.position;
        var offW = active.offsetWidth, offH = active.offsetHeight;

        // Walk ancestor chain to detect display:none parents or transforms.
        var chain = [];
        var p = active;
        var hiddenAncestor = null;
        for (var i = 0; p && i < 12; i++) {
          var pcs = window.getComputedStyle(p);
          chain.push({
            node: (p.tagName || '').toLowerCase(),
            id: p.id || '',
            cls: (p.className || '').toString().substring(0, 80),
            display: pcs.display,
            visibility: pcs.visibility,
            opacity: pcs.opacity,
            position: pcs.position,
            transform: pcs.transform,
          });
          if (!hiddenAncestor && (pcs.display === 'none' || pcs.visibility === 'hidden' || pcs.opacity === '0')) {
            hiddenAncestor = p;
          }
          if (p === document.body) break;
          p = p.parentElement;
        }

        var modal = document.getElementById('join-debug-modal');
        var modalShown = !!(modal && window.getComputedStyle(modal).display !== 'none');
        status.textContent = active.id.replace('view-','') + ' ' + Math.round(r.w||r.width) + 'x' + Math.round(r.h||r.height) +
          ' disp:' + cs.display +
          (transform && transform !== 'none' ? ' tr' : '') +
          (hiddenAncestor ? ' ancHID' : '') +
          (modalShown ? ' MODAL!' : '') +
          (cr ? ' ch:'+Math.round(cr.width)+'x'+Math.round(cr.height) : ' no-children');
        console.log('[v54] INSP:', {
          activeId: active.id,
          rect: { w: r.width, h: r.height },
          offset: { w: offW, h: offH },
          display: cs.display,
          visibility: cs.visibility,
          opacity: cs.opacity,
          position: position,
          transform: transform,
          isConnected: !!active.isConnected,
          children: active.children.length,
          innerHTMLLength: active.innerHTML.length,
          joinDebugModalShown: modalShown,
          ancestorChain: chain,
        });
      };
      dbg.appendChild(inspBtn);

      // Clear common fullscreen overlays/modals (debug convenience)
      var clearBtn = document.createElement('button');
      clearBtn.textContent = 'CLEAR';
      clearBtn.style.cssText = 'background:#2a2a2a;color:#fff;border:1px solid #666;padding:2px 5px;font-size:9px;cursor:pointer;border-radius:3px;';
      clearBtn.title = 'Hide overlays/modals that may cover the view';
      clearBtn.onclick = function() {
        ['join-debug-modal','avatar-picker-modal','overlay-paused','overlay-frozen'].forEach(function(id){
          var el = document.getElementById(id);
          if (el) el.style.display = 'none';
        });
        flags.textContent = 'overlays: cleared';
      };
      dbg.appendChild(clearBtn);

      document.body.appendChild(dbg);

      window.__dbgLog = function(msg) {
        status.textContent = msg;
        console.log('[v54] ' + msg);
      };

      function _isShown(id) {
        var el = document.getElementById(id);
        if (!el) return false;
        var cs = window.getComputedStyle(el);
        return cs.display !== 'none' && cs.visibility !== 'hidden' && cs.opacity !== '0';
      }

      function _updateFlags() {
        var parts = [];
        if (_isShown('join-debug-modal')) parts.push('JOIN-MODAL');
        if (_isShown('avatar-picker-modal')) parts.push('AVATAR-MODAL');
        if (_isShown('overlay-paused')) parts.push('PAUSED');
        if (_isShown('overlay-frozen')) parts.push('FROZEN');
        var active = document.querySelector('.view.active');
        if (active) {
          var cs = window.getComputedStyle(active);
          parts.push(active.id.replace('view-','') + ':' + cs.display);
        }
        flags.textContent = parts.length ? ('overlays: ' + parts.join(' ')) : '';
      }

      setInterval(_updateFlags, 500);

      // Track active .view changes
      var observer = new MutationObserver(function() {
        var active = document.querySelector('.view.active');
        if (active) {
          window.__dbgLog('view=' + active.id);
          // Highlight active view
          document.querySelectorAll('.view').forEach(v => { v.style.border = 'none'; v.style.boxShadow = 'none'; });
          active.style.border = '3px solid #0f0';
          active.style.boxShadow = 'inset 0 0 40px rgba(0,255,0,0.1)';
        }
      });
      
      setTimeout(function() {
        var viewEls = document.querySelectorAll('.view');
        for (var i = 0; i < viewEls.length; i++) {
          observer.observe(viewEls[i], { attributes: true, attributeFilter: ['class'] });
        }
        var active = document.querySelector('.view.active');
        if (active) window.__dbgLog('init view=' + active.id);
      }, 300);

      window.addEventListener('error', function(e) {
        window.__dbgLog('FATAL: ' + (e.message || e).substring(0,40));
        dbg.style.background = '#800';
      });
    })();
  </script>

  <!-- ═══════════════════════════════════════════════════════════════════
       ⚠️ TEMPORARY: TEST RENDERER PANEL - REMOVE AFTER V59 TESTING ⚠️
       ═══════════════════════════════════════════════════════════════════ -->
  
  <!-- Floating test button (bottom-right corner) -->
  <button id="btn-open-test" class="btn-test-trigger" onclick="window.__openTestPanel && window.__openTestPanel()" style="
    position: fixed;
    bottom: 80px;
    right: 20px;
    z-index: 10000;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: 2px solid rgba(255,255,255,0.3);
    padding: 12px 20px;
    border-radius: 12px;
    font-weight: 700;
    font-size: 0.9rem;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    transition: all 0.2s ease;
  " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
    🧪 Test Renderers
  </button>

  <!-- Test Panel Overlay -->
  <div id="test-renderer-panel" style="
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 10001;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
    box-sizing: border-box;
  ">
    <!-- Test Controls Header -->
    <div style="
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 15px 25px;
      border-radius: 12px 12px 0 0;
      width: 100%;
      max-width: 800px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    ">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <h2 style="margin: 0; font-size: 1.3rem;">🧪 Renderer Test Mode</h2>
        <button id="btn-close-test" style="
          background: rgba(255, 255, 255, 0.2);
          border: 1px solid rgba(255, 255, 255, 0.3);
          color: white;
          padding: 8px 16px;
          border-radius: 8px;
          cursor: pointer;
          font-weight: 600;
        ">✕ Close</button>
      </div>
      <p id="test-info" style="margin: 8px 0 0 0; opacity: 0.9; font-size: 0.95rem;">Loading...</p>
    </div>

    <!-- Test Question Container (mimics player question view) -->
    <div id="test-question-container" style="
      background: linear-gradient(to bottom, #0f172a, #1e293b);
      width: 100%;
      max-width: 800px;
      min-height: 400px;
      padding: 30px;
      box-sizing: border-box;
      overflow-y: auto;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    ">
      <!-- Question text -->
      <div id="player-question-text" style="
        color: white;
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 25px;
        text-align: center;
      ">Question will appear here...</div>

      <!-- All question type containers (same as in main game) -->
      <div id="player-options-grid" style="
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 12px;
        margin-bottom: 20px;
      "></div>

      <div id="player-type-container" style="display: none;">
        <input type="text" id="player-type-input" placeholder="Type your answer..." style="
          width: 100%;
          padding: 15px;
          font-size: 1.1rem;
          border: 2px solid #475569;
          border-radius: 8px;
          background: #1e293b;
          color: white;
          box-sizing: border-box;
        " />
      </div>

      <div id="player-boss-panel" class="boss-panel" style="display:none">
        <div class="boss-row">
          <span class="boss-name" id="player-boss-name">Test Boss</span>
          <span class="boss-hp" id="player-boss-hp">75 / 100</span>
        </div>
        <div class="boss-bar"><div class="boss-bar-fill" id="player-boss-bar-fill"></div></div>
      </div>

      <div id="player-match-container" class="match-container" style="display:none"></div>
      
      <div id="player-order-container" class="order-container" style="display:none">
        <ol class="order-list" id="order-list"></ol>
      </div>

      <!-- Submit button (for multi/match/order/type) -->
      <button id="btn-submit-answer" class="btn btn-success full-width" style="display:none; margin-top: 20px;">
        ✔ Submit Answer
      </button>
    </div>

    <!-- Test Navigation Controls -->
    <div style="
      background: #1e293b;
      padding: 20px 25px;
      border-radius: 0 0 12px 12px;
      width: 100%;
      max-width: 800px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      display: flex;
      gap: 12px;
      justify-content: center;
      align-items: center;
    ">
      <button id="btn-test-prev" class="btn btn-secondary" style="flex: 1;">← Previous</button>
      <button id="btn-test-submit" class="btn btn-primary" style="flex: 1;">📋 Get Answer</button>
      <button id="btn-test-next" class="btn btn-secondary" style="flex: 1;">Next →</button>
    </div>
  </div>

  <script type="module">
    // TEMPORARY: Test renderer controls - Remove after V59 testing
    import { showTestPanel, hideTestPanel } from './js/test-renderers.js';

    window.__openTestPanel = () => {
      try {
        showTestPanel();
      } catch (err) {
        console.error('[TEST] open failed:', err);
        const panel = document.getElementById('test-renderer-panel');
        if (panel) panel.style.display = 'flex';
      }
    };

    window.__closeTestPanel = () => {
      try {
        hideTestPanel();
      } catch (err) {
        console.error('[TEST] close failed:', err);
        const panel = document.getElementById('test-renderer-panel');
        if (panel) panel.style.display = 'none';
      }
    };

    ['btn-open-test', 'btn-open-test-home', 'btn-open-test-bottom'].forEach((id) => {
      const button = document.getElementById(id);
      if (button) button.addEventListener('click', window.__openTestPanel);
    });

    const closeButton = document.getElementById('btn-close-test');
    if (closeButton) closeButton.addEventListener('click', window.__closeTestPanel);
  </script>
  
  <!-- ═══════════════════════════════════════════════════════════════════
       END TEMPORARY TEST CODE
       ═══════════════════════════════════════════════════════════════════ -->

  <!-- ─── Scripts ─── -->
  <!-- Confetti for game over celebration (async — non-blocking) -->
  <script async src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <!-- Load Socket.io client from the server (auto-served by socket.io) -->
  <script src="/socket.io/socket.io.js"></script>
  <!-- Main game logic (ES6 module) -->
  <script type="module" src="/js/game.js?v=63"></script>
  <!-- TEMPORARY: Test renderer module - Remove after V59 testing -->
  <script type="module" src="/js/test-renderers.js"></script>
</body>
</html>
